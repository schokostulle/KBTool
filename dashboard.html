<!-- ========================================================= -->
<!-- FILE: dashboard.html â€“ Kompatibel mit style.css            -->
<!-- ========================================================= -->
<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>âš“ Dashboard â€“ Seefahrer Kommando</title>
  <link rel="stylesheet" href="./CSS/style.css" />
</head>

<body>
  <!-- HEADER -->
  <header>
    <h1>âš“ Seefahrer-Kommando â€“ Dashboard</h1>
    <button id="logout-button">Logout</button>
  </header>

  <!-- NAVIGATION -->
  <nav>
    <ul id="nav-menu">
      <li><a href="./dashboard.html">ğŸ  Start</a></li>
      <li><a href="./tools/tool1.html">âš™ï¸ Tool 1</a></li>
      <li><a href="./tools/tool2.html">ğŸ§­ Tool 2</a></li>
      <li class="admin-only"><a href="./tools/mitglieder.html">ğŸ‘‘ Mitglieder</a></li>
    </ul>
  </nav>

  <!-- INHALT -->
  <main>
    <section id="welcome-section">
      <h2 id="welcome-message">Willkommen, Seefahrer!</h2>
      <p>Hier erscheinen Neuigkeiten und AnkÃ¼ndigungen.</p>
    </section>

    <section id="news-section">
      <h3>ğŸ“œ Letzte Meldungen</h3>
      <ul id="news-list">
        <li>â€“ Keine EintrÃ¤ge â€“</li>
      </ul>
    </section>
  </main>

  <footer>
    <p>âš“ Seefahrer-Kommando Â© 2025</p>
  </footer>

  <!-- SCRIPT -->
  <script type="module">
    import { supabase } from './JS/supabase.js';

    // SEGMENT: Logout
    document.getElementById('logout-button').addEventListener('click', async () => {
      await supabase.auth.signOut();
      window.location.href = './index.html';
    });

    // SEGMENT: SessionprÃ¼fung
    async function checkSession() {
      const { data } = await supabase.auth.getSession();
      if (!data.session) {
        window.location.href = './index.html';
        return;
      }

      const user = data.session.user;
      const { data: profile } = await supabase
        .from('profiles')
        .select('username, role')
        .eq('id', user.id)
        .single();

      document.getElementById('welcome-message').textContent =
        `âš“ Willkommen, ${profile?.username || 'Seefahrer'}!`;

      // Admin-Sichtbarkeit
      document.querySelectorAll('.admin-only').forEach(el => {
        el.style.display = profile?.role === 'admin' ? 'list-item' : 'none';
      });
    }

    checkSession();
  </script>
</body>
</html>