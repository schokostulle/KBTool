<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<title>Allianz Dashboard</title>
<style>
  :root {
    --bg: #f9fafb;
    --card: #ffffff;
    --border: #e5e7eb;
    --text: #111827;
    --accent: #2563eb;
    --shadow: 0 3px 8px rgba(0,0,0,0.08);
    --radius: 12px;
  }
  body {
    font-family: "Inter", system-ui, sans-serif;
    background: var(--bg);
    color: var(--text);
    padding: 2rem;
  }
  h1 { font-size: 1.8rem; margin-bottom: 1rem; }
  h2 { font-size: 1.3rem; margin-bottom: .5rem; }

  .hidden { display: none; }

  .dashboard {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 1rem;
  }

  .card {
    background: var(--card);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    padding: 1.2rem;
    text-align: center;
    cursor: pointer;
    transition: transform 0.15s ease;
  }
  .card:hover {
    transform: scale(1.03);
    background: #eef2ff;
  }

  table {
    border-collapse: collapse;
    width: 100%;
    margin-top: 1rem;
    border-radius: var(--radius);
    overflow: hidden;
  }
  th, td {
    border-bottom: 1px solid var(--border);
    padding: 8px 10px;
    text-align: left;
    font-size: 14px;
  }
  th { background: #f3f4f6; font-weight: 600; }
</style>
</head>
<body>

<h1>Allianz Dashboard</h1>

<!-- Dashboard-Start -->
<div id="dashboard">
  <div class="dashboard">
    <div class="card" onclick="showPage('csvView')">üìú Insel√ºbersicht (CSV)</div>
    <div class="card" onclick="showPage('statsView')">üìà Allianz-Statistik</div>
    <div class="card" onclick="showPage('reportsView')">‚öîÔ∏è Kampfberichte</div>
  </div>
</div>

<!-- CSV-Anzeige (Platzhalter f√ºr sp√§tere Integration deiner bisherigen Tabelle) -->
<div id="csvView" class="hidden">
  <button onclick="showPage('dashboard')">‚¨ÖÔ∏è Zur√ºck</button>
  <h2>CSV Datenbasis</h2>
  <p>Diese Tabelle basiert auf den eingelesenen CSV-Daten.</p>
  <div id="csvTable">Noch keine CSV geladen.</div>
</div>

<!-- Neue Tabelle: Allianz-Statistik -->
<div id="statsView" class="hidden">
  <button onclick="showPage('dashboard')">‚¨ÖÔ∏è Zur√ºck</button>
  <h2>Allianz-Statistik</h2>
  <p>Basierend auf den Daten der CSV-Datei.</p>
  <div id="statsTable"></div>
</div>

<!-- Kampfberichte (sp√§teres Modul) -->
<div id="reportsView" class="hidden">
  <button onclick="showPage('dashboard')">‚¨ÖÔ∏è Zur√ºck</button>
  <h2>Kampfberichte</h2>
  <p>Wird sp√§ter hinzugef√ºgt.</p>
</div>

<script>
  let csvData = [];

  // Navigation zwischen "Seiten"
  function showPage(page) {
    document.querySelectorAll("#dashboard, #csvView, #statsView, #reportsView")
      .forEach(el => el.classList.add("hidden"));
    document.getElementById(page).classList.remove("hidden");
  }

  // Beispiel CSV laden (sp√§ter via Firebase oder Upload)
  const csvText = `1;12;1;Insel Alpha;123;Spieler1;11;TAG;Allianz Blau;1200
1;12;2;Insel Beta;124;Spieler2;11;TAG;Allianz Blau;800
1;13;3;Insel Gamma;125;Spieler3;12;ROT;Allianz Rot;950
1;13;4;Insel Delta;126;Spieler4;12;ROT;Allianz Rot;1100
1;14;5;Insel Epsilon;127;Spieler5;13;GRN;Allianz Gr√ºn;500`;

  csvData = csvText.split("\n").map(l => {
    const v = l.split(";");
    return {
      "Ozean": v[0],
      "Inselgruppe": v[1],
      "Insel": v[2],
      "Inselname": v[3],
      "Spieler ID": v[4],
      "Spielername": v[5],
      "Allianz ID": v[6],
      "Allianz K√ºrzel": v[7],
      "Allianzname": v[8],
      "Punkte": parseInt(v[9])
    };
  });

  renderCSVTable();
  renderStatsTable();

  // CSV Tabelle rendern
  function renderCSVTable() {
    const div = document.getElementById("csvTable");
    let html = "<table><thead><tr><th>Oz</th><th>IG</th><th>I</th><th>Inselname</th><th>Spieler</th><th>Allianz</th><th>Punkte</th></tr></thead><tbody>";
    csvData.forEach(r => {
      html += `<tr><td>${r.Ozean}</td><td>${r.Inselgruppe}</td><td>${r.Insel}</td><td>${r.Inselname}</td><td>${r["Spielername"]}</td><td>${r["Allianzname"]}</td><td>${r.Punkte}</td></tr>`;
    });
    html += "</tbody></table>";
    div.innerHTML = html;
  }

  // Allianzstatistik aus CSV berechnen
  function renderStatsTable() {
    const div = document.getElementById("statsTable");

    // Daten aggregieren pro Allianz
    const allianzMap = {};
    csvData.forEach(r => {
      const a = r["Allianzname"];
      if (!allianzMap[a]) allianzMap[a] = { allianz: a, punkte: 0, inseln: 0, spieler: new Set() };
      allianzMap[a].punkte += r.Punkte;
      allianzMap[a].inseln += 1;
      allianzMap[a].spieler.add(r["Spielername"]);
    });

    const stats = Object.values(allianzMap).map(a => ({
      Allianz: a.allianz,
      Inseln: a.inseln,
      Spieler: a.spieler.size,
      Gesamtpunkte: a.punkte,
      Durchschnitt: Math.round(a.punkte / a.spieler.size)
    }));

    // Tabelle
    let html = "<table><thead><tr><th>Allianz</th><th>Inseln</th><th>Spieler</th><th>Gesamtpunkte</th><th>√ò Punkte / Spieler</th></tr></thead><tbody>";
    stats.forEach(s => {
      html += `<tr><td>${s.Allianz}</td><td>${s.Inseln}</td><td>${s.Spieler}</td><td>${s.Gesamtpunkte}</td><td>${s.Durchschnitt}</td></tr>`;
    });
    html += "</tbody></table>";
    div.innerHTML = html;
  }
</script>
</body>
</html>